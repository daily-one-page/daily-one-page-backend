# ì˜¤ëŠ˜í•œì¥ ERD ì„¤ê³„ ë¬¸ì„œ

## 1. ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ ì†Œê°œ
**ì˜¤ëŠ˜í•œì¥**ì€ ë§¤ì¼ í•œ í˜ì´ì§€ì”© í•˜ë£¨ë¥¼ ê¸°ë¡í•˜ì—¬ ë‚˜ë§Œì˜ ì¸ìƒ ë…¸íŠ¸ë¥¼ ì™„ì„±í•˜ëŠ” ìŠµê´€ í˜•ì„± í”Œë«í¼ì´ë‹¤.

### 1.2 ì„¤ê³„ ëª©í‘œ
- MVP 2ê°œì›” ë‚´ ê°œë°œ ê°€ëŠ¥í•œ êµ¬ì¡°
- ê¸ˆìœµê¶Œ ì·¨ì—… ì–´í•„ì„ ìœ„í•œ ê¸°ìˆ  ìŠ¤íƒ (Spring Boot, MySQL, Redis, JPA)
- í–¥í›„ ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ í™•ì¥ ê°€ëŠ¥ì„± ê³ ë ¤

---

## 2. ì™œ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤(RDB)ì¸ê°€?

### 2.1 RDBë€?
MySQL, PostgreSQL, Oracle ê°™ì€ **ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤**ë¥¼ ë§í•œë‹¤.
- ë°ì´í„°ë¥¼ **í…Œì´ë¸”(í–‰/ì—´)** í˜•íƒœë¡œ ì €ì¥
- í…Œì´ë¸”ë¼ë¦¬ **ê´€ê³„(FK)**ë¡œ ì—°ê²°
- SQLë¡œ ì¡°íšŒ

### 2.2 NoSQL vs RDB ë¹„êµ

ì˜¤ëŠ˜í•œì¥ì—ì„œ ìŠµê´€ ë¡œê·¸ë¥¼ ì €ì¥í•˜ëŠ” ë°©ì‹ì„ ì˜ˆë¡œ ë“¤ì–´ë³´ì.

| ë°©ì‹ | êµ¬ì¡° | ì¥ì  | ë‹¨ì  |
|------|------|------|------|
| **NoSQL (ë‚ ì§œ ë¦¬ìŠ¤íŠ¸)** | habit_id + ["2025-01-18", "2025-01-19", ...] | ë ˆì½”ë“œ ì ìŒ | íŠ¹ì • ë‚ ì§œ ì¡°íšŒ ë³µì¡, ì •ê·œí™” ìœ„ë°˜ |
| **RDB (ë‚ ì§œë³„ ë ˆì½”ë“œ)** | habit_id + date + checked (í–‰ë§ˆë‹¤) | ì¿¼ë¦¬ ë‹¨ìˆœ, í™•ì¥ ì‰¬ì›€ | ë ˆì½”ë“œ ë§ì•„ì§ |

### 2.3 ì´ í”„ë¡œì íŠ¸ì— RDBê°€ ì í•©í•œ ì´ìœ 

**1) ë°ì´í„° ê°„ ê´€ê³„ê°€ ëª…í™•í•˜ë‹¤**
```
User â†’ Habit â†’ HabitLog
User â†’ DailyPage
User â†’ Badge â†’ UserBadge
```
í…Œì´ë¸” ê°„ FKë¡œ ì—°ê²°ë˜ëŠ” êµ¬ì¡°ê°€ ë§ì•„ RDBì˜ JOINì´ íš¨ìœ¨ì ì´ë‹¤.

**2) ì¡°íšŒ íŒ¨í„´ì´ ê´€ê³„í˜•ì— ì í•©í•˜ë‹¤**
- "1ì›” 20ì¼ì— ì´ ìŠµê´€ ì²´í¬í–ˆë‚˜?" â†’ `WHERE habit_id = ? AND date = ?`
- "ì´ ì‚¬ìš©ìì˜ ëª¨ë“  ìŠµê´€ ëª©ë¡" â†’ `WHERE user_id = ?`
- "ê¸ˆì—°í•˜ëŠ” ì‚¬ìš©ì ëª‡ ëª…?" â†’ `WHERE habit_id = ? GROUP BY`

NoSQLì—ì„œëŠ” ì´ëŸ° ì¿¼ë¦¬ê°€ ë³µì¡í•´ì§€ê±°ë‚˜ ë¹„íš¨ìœ¨ì ì´ë‹¤.

**3) íŠ¸ëœì­ì…˜ ì²˜ë¦¬ í•„ìš”**
ìŠµê´€ ì²´í¬ ì‹œ HabitLog ì €ì¥ + ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸ + ë±ƒì§€ ì§„í–‰ë¥  ê°±ì‹ ì´ í•œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ì•¼ í•œë‹¤.
RDBì˜ ACID íŠ¹ì„±ì´ ë°ì´í„° ì •í•©ì„±ì„ ë³´ì¥í•œë‹¤.

**4) ê¸ˆìœµê¶Œ ì·¨ì—… ëª©í‘œ**
ê¸ˆìœµê¶Œì—ì„œëŠ” MySQL, Oracle ë“± RDBê°€ í‘œì¤€ì´ë‹¤. ë©´ì ‘ì—ì„œ RDB ì„¤ê³„ ë° ìµœì í™” ê²½í—˜ì„ ì–´í•„í•  ìˆ˜ ìˆë‹¤.

---

## 3. í•µì‹¬ ì—”í‹°í‹° ë„ì¶œ

### 3.1 "ì •ì˜"ì™€ "ê¸°ë¡" ë¶„ë¦¬ ì›ì¹™

ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì˜ í•µì‹¬ì€ **"ë¬´ì—‡ì„"**ê³¼ **"ì–¸ì œ í–ˆëŠ”ì§€"**ë¥¼ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤.

| êµ¬ë¶„ | ì •ì˜ (Definition) | ê¸°ë¡ (Log/History) |
|------|-------------------|-------------------|
| ìŠµê´€ | "ë¬¼ 2L ë§ˆì‹œê¸°"ë¼ëŠ” ìŠµê´€ ìì²´ | 1ì›” 20ì¼ì— ì²´í¬í–ˆëŠ”ì§€ |
| ë±ƒì§€ | "ì¹˜í‚¨ 1ë§ˆë¦¬ ê°’ ì ˆì•½!" ë±ƒì§€ ì •ë³´ | ì •ìš°ì°¬ì´ ì´ ë±ƒì§€ë¥¼ íšë“í–ˆë‹¤ |

ì´ ì›ì¹™ì— ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ ì—”í‹°í‹°ë¥¼ ë„ì¶œí–ˆë‹¤:

### 3.2 ì—”í‹°í‹° ëª©ë¡

| í…Œì´ë¸” | ì—­í•  | ë¹„ê³  |
|--------|------|------|
| User | ì‚¬ìš©ì | |
| Habit | ìŠµê´€ ì •ì˜ (í…œí”Œë¦¿) | ì‹œìŠ¤í…œ/ì»¤ìŠ¤í…€ í†µí•© |
| UserHabit | ì‚¬ìš©ìë³„ ìŠµê´€ | ìŠ¤íŠ¸ë¦­ ê´€ë¦¬ |
| HabitLog | ë‚ ì§œë³„ ì²´í¬ ê¸°ë¡ | |
| BadgeSet | ë±ƒì§€ì„¸íŠ¸ ì •ì˜ | ì‹œìŠ¤í…œ/ì»¤ìŠ¤í…€/ë²”ìš© êµ¬ë¶„ |
| Badge | ê°œë³„ ë±ƒì§€ ì •ì˜ | ì„¸íŠ¸ ë‚´ ìˆœì„œ ê´€ë¦¬ |
| UserBadgeSet | ì‚¬ìš©ìë³„ ë±ƒì§€ì„¸íŠ¸ ì§„í–‰ | |
| UserBadge | íšë“í•œ ë±ƒì§€ | |
| DailyPage | ë°ì¼ë¦¬ í˜ì´ì§€ | |
| AiFeedback | AI í”¼ë“œë°± | |

---

## 4. ì£¼ìš” ì„¤ê³„ ê²°ì •

### 4.1 ìŠµê´€ (Habit) ì„¤ê³„

#### Q1. ì‹¤ì²œìŠµê´€ê³¼ ì ˆì œìŠµê´€ì„ í…Œì´ë¸”ë¡œ ë¶„ë¦¬í• ê¹Œ?

**ê²°ì •: í†µí•© (type ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ë¶„)**

| í•­ëª© | ì‹¤ì²œìŠµê´€ | ì ˆì œìŠµê´€ |
|------|----------|----------|
| name | âœ… | âœ… |
| user_id | âœ… | âœ… |
| current_streak | âœ… | âœ… |

ì»¬ëŸ¼ì´ ë™ì¼í•˜ê³ , ì°¨ì´ëŠ” **ì²´í¬ì˜ ì˜ë¯¸**ë¿ì´ë‹¤:
- ì‹¤ì²œ: ì²´í¬ = ì„±ê³µ
- ì ˆì œ: ì²´í¬ = ì‹¤íŒ¨

```java
if (type == "PRACTICE") {
    // ì²´í¬í•œ ë‚  = ì„±ê³µ
} else {
    // ì²´í¬ ì•ˆ í•œ ë‚  = ì„±ê³µ
}
```

ë¶„ë¦¬í•˜ë©´ ì¤‘ë³µ ì½”ë“œê°€ ë§ì•„ì§€ê³ , ìƒˆ íƒ€ì… ì¶”ê°€ ì‹œ í…Œì´ë¸”ì„ ë˜ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

#### Q2. ì‹œìŠ¤í…œ ìŠµê´€ê³¼ ì‚¬ìš©ì ìŠµê´€ì„ ì–´ë–»ê²Œ ê´€ë¦¬í• ê¹Œ?

**ë¬¸ì œ ìƒí™©:**
ì‹œìŠ¤í…œ ìŠµê´€ "ê¸ˆì—°"ì´ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´, ì‚¬ìš©ìAì˜ ìŠ¤íŠ¸ë¦­(7ì¼)ê³¼ ì‚¬ìš©ìBì˜ ìŠ¤íŠ¸ë¦­(30ì¼)ì„ ì–´ë””ì— ì €ì¥í• ê¹Œ?

**ì„ íƒì§€ ë¹„êµ:**

| í•­ëª© | A. ë³µì‚¬ ë°©ì‹ | B. ì¤‘ê°„ í…Œì´ë¸” ë°©ì‹ |
|------|-------------|-------------------|
| êµ¬ì¡° | ì‚¬ìš©ìê°€ ì„ íƒí•˜ë©´ Habit ë³µì‚¬ | Habit(í…œí”Œë¦¿) + UserHabit(ì‚¬ìš©ìë³„) |
| í…Œì´ë¸” ìˆ˜ | ì ìŒ | ë§ìŒ |
| ì¡°íšŒ | JOIN ì—†ìŒ | JOIN í•„ìš” |
| ì‹œìŠ¤í…œ ìŠµê´€ ì´ë¦„ ìˆ˜ì • | ë³µì‚¬ë³¸ ì „ë¶€ UPDATE í•„ìš” | í•œ ê³³ë§Œ ìˆ˜ì • |
| "ê¸ˆì—° í•˜ëŠ” ì‚¬ëŒ ëª‡ ëª…?" | ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰ (ë¶ˆì•ˆì •) | habit_idë¡œ ê²€ìƒ‰ (í™•ì‹¤) |

**ê²°ì •: B. ì¤‘ê°„ í…Œì´ë¸” ë°©ì‹**

ì´ìœ :
- ì‹œìŠ¤í…œ ìŠµê´€ ìˆ˜ì •ì´ ì‰¬ì›€
- ë‚˜ì¤‘ì— "ê¸ˆì—° ì±Œë¦°ì§€ ì°¸ì—¬ì 100ëª…!" ê°™ì€ ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ì— ìœ ë¦¬
- ID ê¸°ë°˜ í†µê³„ê°€ ì •í™•í•¨

```
Habit (í…œí”Œë¦¿)
- id: 1, user_id: null, name: "ê¸ˆì—°" (ì‹œìŠ¤í…œ)
- id: 2, user_id: 123, name: "ë…ì„œ" (ì»¤ìŠ¤í…€)

UserHabit (ì‚¬ìš©ìë³„)
- user_id: A, habit_id: 1, streak: 7
- user_id: B, habit_id: 1, streak: 30
```

---

### 4.2 ìŠ¤íŠ¸ë¦­ (Streak) ê´€ë¦¬

#### Q1. ë§¤ë²ˆ ê³„ì‚°í• ê¹Œ, ì €ì¥í•´ë‘˜ê¹Œ?

**ì„ íƒì§€ ë¹„êµ:**

| ë°©ì‹ | ì„¤ëª… | ì¥ë‹¨ì  |
|------|------|--------|
| ë§¤ë²ˆ ê³„ì‚° | ì¡°íšŒí•  ë•Œ HabitLogì—ì„œ ì—°ì† ì¼ìˆ˜ ê³„ì‚° | ì •í™•í•˜ì§€ë§Œ ì¿¼ë¦¬ ë³µì¡, ì„±ëŠ¥ ì´ìŠˆ |
| ì €ì¥ | UserHabitì— current_streak ì»¬ëŸ¼ | ë¹ ë¥´ì§€ë§Œ ë™ê¸°í™” í•„ìš” |

**ê²°ì •: ì €ì¥ ë°©ì‹**

```
UserHabit
- current_streak: 7
- last_checked_date: 2025-01-20
```

ì²´í¬í•  ë•Œ ë¡œì§:
```
if (last_checked_date == ì–´ì œ):
    current_streak += 1
else:
    current_streak = 1  // ë¦¬ì…‹
```

#### Q2. ê³¼ê±° ê¸°ë¡ ìˆ˜ì •ì„ í—ˆìš©í•˜ë©´?

**ê³ ë ¤ ì‚¬í•­:**
ì‚¬ìš©ìê°€ "ì–´ì œ ê¹œë¹¡í–ˆëŠ”ë° ì˜¤ëŠ˜ ì±„ìš°ê¸°" ê°™ì€ ê³¼ê±° ìˆ˜ì •ì„ í•  ìˆ˜ ìˆë‹¤.

**ê²°ì •: ê³¼ê±° ìˆ˜ì • í—ˆìš© (3ì¼ ì´ë‚´) + ì¬ê³„ì‚° íŠ¸ë¦¬ê±°**

```
[ì˜¤ëŠ˜ ì²´í¬]
â†’ streak += 1, Redis ê°±ì‹ 

[ê³¼ê±° ìˆ˜ì •]
â†’ í•´ë‹¹ ìŠµê´€ì˜ ì „ì²´ ë¡œê·¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦­ ì¬ê³„ì‚°
â†’ DB ì €ì¥ + Redis ìºì‹œ ë¬´íš¨í™”
```

ì½ê¸°(ì¡°íšŒ)ëŠ” ìì£¼, ì“°ê¸°(ìˆ˜ì •)ëŠ” ê°€ë”ì´ë‹ˆê¹Œ ìºì‹± íš¨ê³¼ ì—¬ì „íˆ ìœ íš¨í•˜ë‹¤.

#### Q3. Redis ìºì‹±ì€ ì™œ ì“°ë‚˜?

**ìºì‹œë¥¼ ì“°ëŠ” ì´ìœ :**
```
DB ì¡°íšŒ: ~10ms
Redis ì¡°íšŒ: ~0.5ms
```

ë™ì‹œ ì ‘ì† 1,000ëª…ì´ ìŠ¤íŠ¸ë¦­ ì¡°íšŒí•˜ë©´:
```
DBë§Œ: 1,000 Ã— 10ms = 10ì´ˆ ë™ì•ˆ DB ì ìœ 
Redis: 1,000 Ã— 0.5ms = 0.5ì´ˆ
```

**ìºì‹± íë¦„:**

```
[ì½ê¸°: ì•± ì¼œì„œ ìŠ¤íŠ¸ë¦­ ì¡°íšŒ]
1. Redis í™•ì¸: GET streak:user:123:habit:456
2. ìˆìœ¼ë©´ â†’ ë°”ë¡œ ë°˜í™˜ (HIT)
3. ì—†ìœ¼ë©´ â†’ DB ì¡°íšŒ â†’ Redisì— ì €ì¥ â†’ ë°˜í™˜ (MISS)

[ì“°ê¸°: ìŠµê´€ ì²´í¬]
1. DB ì—…ë°ì´íŠ¸: current_streak = 8
2. Redisë„ ê°±ì‹ : SET streak:user:123:habit:456 = 8
â†’ ë‘˜ì´ í•­ìƒ ë™ê¸°í™” (Write-Through ì „ëµ)

[ê³¼ê±° ìˆ˜ì •]
1. ìŠ¤íŠ¸ë¦­ ì¬ê³„ì‚°
2. DB ì—…ë°ì´íŠ¸
3. Redis ìºì‹œ ë¬´íš¨í™” (Cache Invalidation)
```

**ë©´ì ‘ ì–´í•„ í¬ì¸íŠ¸:**
> "ìŠ¤íŠ¸ë¦­ì²˜ëŸ¼ ìì£¼ ì¡°íšŒë˜ì§€ë§Œ ë³€ê²½ì€ í•˜ë£¨ í•œ ë²ˆì¸ ë°ì´í„°ëŠ” Redisì— ìºì‹±í–ˆìŠµë‹ˆë‹¤. Write-Through ì „ëµìœ¼ë¡œ ë°ì´í„° ì •í•©ì„±ì„ ìœ ì§€í•˜ê³ , ê³¼ê±° ìˆ˜ì • ì‹œì—ëŠ” ìºì‹œ ë¬´íš¨í™”ë¡œ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤."

**ì£¼ì˜:** MVP ì‚¬ìš©ì 100ëª… ìˆ˜ì¤€ì´ë©´ ìºì‹œ ì—†ì–´ë„ ë¬¸ì œì—†ë‹¤. ê¸ˆìœµê¶Œ ì·¨ì—… ì–´í•„ìš©ìœ¼ë¡œ ë„£ëŠ” ê²ƒì´ë©°, ì¼ë‹¨ DBë§Œìœ¼ë¡œ MVP ì™„ì„± í›„ Redis ì¶”ê°€ë„ ê°€ëŠ¥í•˜ë‹¤.

---

### 4.3 ë±ƒì§€ (Badge) ì„¤ê³„

#### ë±ƒì§€ì˜ ì—­í• 
ë±ƒì§€ = **ìŠµê´€ì˜ ì„¸ë¶€ ëª©í‘œ (ë§ˆì¼ìŠ¤í†¤)**

"7ì¼ ë‹¬ì„±" ê°™ì€ ë‹¨ìˆœ ìˆ«ìê°€ ì•„ë‹ˆë¼, ì°½ì˜ì ìœ¼ë¡œ í™˜ì‚°í•˜ì—¬ ì¬ë¯¸ì™€ ì„±ì·¨ê°ì„ ì œê³µí•œë‹¤.

ì˜ˆì‹œ (ê¸ˆì—°):
- 1ì¼ â†’ ğŸ— ì¹˜í‚¨ 1ë§ˆë¦¬ ê°’ ì ˆì•½!
- 30ì¼ â†’ ğŸ£ ì˜¤ë§ˆì¹´ì„¸ í•œ ë¼ ê°’!
- 100ì¼ â†’ ğŸ§ ì—ì–´íŒŸ í•˜ë‚˜ ë²Œì—ˆë‹¤!

#### Q1. ì‹œìŠ¤í…œ ë±ƒì§€ì™€ ì»¤ìŠ¤í…€ ë±ƒì§€ë¥¼ ë¶„ë¦¬í• ê¹Œ?

**ê²°ì •: í†µí•© (user_id null íŒ¨í„´)**

ìŠµê´€ê³¼ ê°™ì€ ë…¼ë¦¬:
- user_id = null â†’ ì‹œìŠ¤í…œ ë±ƒì§€ì„¸íŠ¸
- user_id = 123 â†’ ì‚¬ìš©ìê°€ ë§Œë“  ì»¤ìŠ¤í…€ ë±ƒì§€ì„¸íŠ¸

ë¶„ë¦¬í•˜ë©´ UserBadgeSetì—ì„œ ì°¸ì¡°í•  ë•Œ "ì–´ëŠ í…Œì´ë¸”ì´ì§€?" ë¶„ê¸°ê°€ í•„ìš”í•´ ë³µì¡í•´ì§„ë‹¤.

#### Q2. ë²”ìš© ë±ƒì§€ì„¸íŠ¸ë€?

**ê°œë…:**
íŠ¹ì • ìŠµê´€ì— ì¢…ì†ë˜ì§€ ì•Šê³  **ëª¨ë“  ìŠµê´€ì— ê³µí†µ ì ìš©**ë˜ëŠ” ë±ƒì§€ì„¸íŠ¸.

ì˜ˆ: "ìŠ¤íŠ¸ë¦­ ë„ì „" (7ì¼ ì—°ì† â†’ 30ì¼ ì—°ì† â†’ 100ì¼ ì—°ì†)

**êµ¬í˜„:**
BadgeSet.habit_id = nullë¡œ ì„¤ì •í•˜ë©´ ë²”ìš© ë±ƒì§€ì„¸íŠ¸ê°€ ëœë‹¤.

| habit_id ê°’ | user_id ê°’ | ì˜ë¯¸ |
|-------------|------------|------|
| not null | null | ì‹œìŠ¤í…œ ìŠµê´€ ì „ìš© ë±ƒì§€ì„¸íŠ¸ (ë‹¬ë¦¬ê¸°â†’ê±°ë¦¬ë„ì „) |
| not null | ìˆìŒ | ì‚¬ìš©ì ì»¤ìŠ¤í…€ ë±ƒì§€ì„¸íŠ¸ (í›„ìˆœìœ„) |
| **null** | null | **ë²”ìš© ìŠ¤íŠ¸ë¦­ ë±ƒì§€ì„¸íŠ¸** (ëª¨ë“  ìŠµê´€ì— ì ìš©) |

**ì ìš© ë¡œì§:**

| ìŠµê´€ ìœ í˜• | ì—°ê²°ë˜ëŠ” BadgeSet |
|-----------|-------------------|
| ì‹œìŠ¤í…œ ìŠµê´€ | ì „ìš© BadgeSet + ë²”ìš© ìŠ¤íŠ¸ë¦­ BadgeSet |
| ì»¤ìŠ¤í…€ ìŠµê´€ | ë²”ìš© ìŠ¤íŠ¸ë¦­ BadgeSetë§Œ |

**ì§„í–‰ ìƒí™© ì¶”ì :**
ë²”ìš© ë±ƒì§€ì„¸íŠ¸ í…œí”Œë¦¿ì€ 1ê°œì´ì§€ë§Œ, UserBadgeSetì—ì„œ ìŠµê´€ë³„ë¡œ ì§„í–‰ìƒí™©ì´ ë¶„ë¦¬ëœë‹¤.

```
BadgeSet "ìŠ¤íŠ¸ë¦­ ë„ì „" (id=1, habit_id=null) â† ë²”ìš© í…œí”Œë¦¿ 1ê°œ

UserBadgeSet ë ˆì½”ë“œë“¤:
â”œâ”€ user_habit_id=10(ë‹¬ë¦¬ê¸°), badge_set_id=1, current_value=15
â”œâ”€ user_habit_id=11(ëª…ìƒ), badge_set_id=1, current_value=7
â””â”€ user_habit_id=12(ì»¤ìŠ¤í…€), badge_set_id=1, current_value=3
```

#### Q3. ë±ƒì§€ ì§„í–‰ ë°©ì‹

**ê²°ì •: ìˆœì°¨ ë‹¬ì„±**

```
ê¸ˆì—° ë±ƒì§€ ìˆœì„œ: ì¹˜í‚¨(1ì¼) â†’ ì˜¤ë§ˆì¹´ì„¸(30ì¼) â†’ ì—ì–´íŒŸ(100ì¼)

[1ì¼ ë‹¬ì„±]
â†’ ì¹˜í‚¨ ë±ƒì§€ íšë“ (UserBadge ìƒì„±)
â†’ UserBadgeSet.current_badge_id = ì˜¤ë§ˆì¹´ì„¸ ë±ƒì§€

[30ì¼ ë‹¬ì„±]
â†’ ì˜¤ë§ˆì¹´ì„¸ ë±ƒì§€ íšë“ (UserBadge ìƒì„±)
â†’ UserBadgeSet.current_badge_id = ì—ì–´íŒŸ ë±ƒì§€
```

---

### 4.4 AI í”¼ë“œë°± ì„¤ê³„

#### Q1. DailyPageì— ì»¬ëŸ¼ìœ¼ë¡œ ë„£ì„ê¹Œ, ë³„ë„ í…Œì´ë¸”ë¡œ ë¶„ë¦¬í• ê¹Œ?

**ì„ íƒì§€:**
```
A. DailyPageì— ai_feedback ì»¬ëŸ¼ ì¶”ê°€
B. AiFeedback í…Œì´ë¸” ë¶„ë¦¬
```

**ê²°ì •: B. ë¶„ë¦¬**

ì´ìœ : **í”¼ë“œë°±ì´ ì—†ëŠ” ë‚ ë„ ìˆë‹¤.**

DailyPageì— ë„£ìœ¼ë©´ ai_feedback = nullì¸ í–‰ì´ ë§ì•„ì§„ë‹¤. ë¶„ë¦¬í•˜ë©´ í”¼ë“œë°±ì´ ìˆì„ ë•Œë§Œ ë ˆì½”ë“œë¥¼ ìƒì„±í•˜ë©´ ëœë‹¤.

#### Q2. í”¼ë“œë°± ìƒì„± íƒ€ì´ë°

**ê²°ì •: ì ‘ì† ì‹œ ìë™ ìƒì„±**

- ì‚¬ìš©ìê°€ ê·¸ë‚  ì²˜ìŒ ì ‘ì†í•˜ë©´ ì–´ì œ ê¸°ë¡ ê¸°ë°˜ìœ¼ë¡œ AI í”¼ë“œë°± ìƒì„±
- ìƒì„±ëœ í”¼ë“œë°±ì€ ì €ì¥ë˜ì–´ ìº˜ë¦°ë”ì—ì„œ ê³¼ê±° í”¼ë“œë°± ì—´ëŒ ê°€ëŠ¥
- í•˜ë£¨ì— í”¼ë“œë°± 1ê°œë§Œ ìƒì„± (ì¬ìƒì„± ë¶ˆê°€)

---

## 5. ERD (BadgeSet í™•ì¥ ë²„ì „)

### 5.1 ì„¤ëª…
- BadgeSetìœ¼ë¡œ ë±ƒì§€ë¥¼ ì„¸íŠ¸ ë‹¨ìœ„ë¡œ ê´€ë¦¬
- í•œ ìŠµê´€ì— ì—¬ëŸ¬ ë±ƒì§€ ì„¸íŠ¸ ë™ì‹œ ì§„í–‰ ê°€ëŠ¥ (ê±°ë¦¬ ë„ì „ + ìŠ¤íŠ¸ë¦­ ë„ì „)
- ì‹œìŠ¤í…œ ë±ƒì§€ì„¸íŠ¸ / ì»¤ìŠ¤í…€ ë±ƒì§€ì„¸íŠ¸ / ë²”ìš© ë±ƒì§€ì„¸íŠ¸ êµ¬ë¶„

### 5.2 ë±ƒì§€ì„¸íŠ¸ ê·œì¹™
- ì‹œìŠ¤í…œ ìŠµê´€ â†’ ì‹œìŠ¤í…œ ë±ƒì§€ì„¸íŠ¸ + ë²”ìš© ë±ƒì§€ì„¸íŠ¸ ìë™ ì—°ê²°
- ì»¤ìŠ¤í…€ ìŠµê´€ â†’ ë²”ìš© ë±ƒì§€ì„¸íŠ¸ë§Œ ìë™ ì—°ê²°
- í•œ ì„¸íŠ¸ ë‚´ì—ì„œëŠ” ìˆœì°¨ ë‹¬ì„± (a â†’ b â†’ c â†’ d)
- ì„¸íŠ¸ ë‚´ ì§„í–‰ ì¤‘ì¸ ë±ƒì§€ëŠ” í•­ìƒ 1ê°œ

### 5.3 ì‚¬ìš©ì íë¦„

```
[íšŒì›ê°€ì…]
User ìƒì„±

[ìŠµê´€ ì¶”ê°€ - ì‹œìŠ¤í…œ ìŠµê´€]
ì‹œìŠ¤í…œ ìŠµê´€ "ë‹¬ë¦¬ê¸°" ì„ íƒ
â†’ UserHabit ìƒì„±
â†’ ì‹œìŠ¤í…œ ë±ƒì§€ì„¸íŠ¸ "ê±°ë¦¬ ë„ì „" ìë™ ì—°ê²° (UserBadgeSet ìƒì„±)
â†’ ë²”ìš© ë±ƒì§€ì„¸íŠ¸ "ìŠ¤íŠ¸ë¦­ ë„ì „" ìë™ ì—°ê²° (UserBadgeSet ìƒì„±)
â†’ í•œ ìŠµê´€ì— 2ê°œ ì„¸íŠ¸ ë™ì‹œ ì§„í–‰!

[ìŠµê´€ ì¶”ê°€ - ì»¤ìŠ¤í…€ ìŠµê´€]
ì»¤ìŠ¤í…€ ìŠµê´€ "ëª…ìƒ" ìƒì„±
â†’ UserHabit ìƒì„±
â†’ ë²”ìš© ë±ƒì§€ì„¸íŠ¸ "ìŠ¤íŠ¸ë¦­ ë„ì „"ë§Œ ìë™ ì—°ê²° (UserBadgeSet ìƒì„±)

[21km ë‹¬ì„±]
â†’ UserBadgeì— "21km ë±ƒì§€" ì™„ë£Œ ê¸°ë¡
â†’ UserBadgeSet.current_badge_id = "42km ë±ƒì§€"ë¡œ ë³€ê²½
â†’ UserBadgeSet.current_value = 0 ë¦¬ì…‹

[7ì¼ ì—°ì† ë‹¬ì„±]
â†’ UserBadgeì— "7ì¼ ë±ƒì§€" ì™„ë£Œ ê¸°ë¡
â†’ UserBadgeSet.current_badge_id = "30ì¼ ë±ƒì§€"ë¡œ ë³€ê²½

[ë°ì¼ë¦¬ í˜ì´ì§€ ì‘ì„±]
â†’ DailyPage ìƒì„±

[ë‹¤ìŒë‚  ì•„ì¹¨ ì ‘ì†]
â†’ AiFeedback ìƒì„± (ì–´ì œ ê¸°ë¡ ê¸°ë°˜)
```

### 5.4 DBML ì½”ë“œ

```dbml
// ì˜¤ëŠ˜í•œì¥ ERD - BadgeSet í™•ì¥ ë²„ì „

Table User {
  id bigint [pk, increment]
  email varchar(255) [unique, not null]
  password varchar(255) [not null]
  nickname varchar(50) [not null]
  alarm_time time [null]
  created_at datetime [not null]
  updated_at datetime [not null]
}

Table Habit {
  id bigint [pk, increment]
  user_id bigint [null, ref: > User.id, note: 'nullì´ë©´ ì‹œìŠ¤í…œ']
  name varchar(100) [not null]
  description varchar(500) [null]
  icon varchar(10) [null, note: 'ì´ëª¨ì§€']
  type enum [not null, note: 'PRACTICE | ABSTINENCE']
  created_at datetime [not null]
}

Table UserHabit {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > User.id]
  habit_id bigint [not null, ref: > Habit.id]
  current_streak int [not null, default: 0]
  last_checked_date date [null]
  created_at datetime [not null]
  updated_at datetime [not null]
}

Table HabitLog {
  id bigint [pk, increment]
  user_habit_id bigint [not null, ref: > UserHabit.id]
  date date [not null]
  checked boolean [not null]
  created_at datetime [not null]
}

Table BadgeSet {
  id bigint [pk, increment]
  user_id bigint [null, ref: > User.id, note: 'nullì´ë©´ ì‹œìŠ¤í…œ']
  habit_id bigint [null, ref: > Habit.id, note: 'nullì´ë©´ ë²”ìš©(ìŠµê´€ ë¬´ê´€)']
  name varchar(100) [not null]
  description varchar(500) [null]
  created_at datetime [not null]
}

Table Badge {
  id bigint [pk, increment]
  badge_set_id bigint [not null, ref: > BadgeSet.id]
  name varchar(100) [not null]
  description varchar(500) [null]
  condition_value int [not null]
  sequence int [not null, note: 'ì„¸íŠ¸ ë‚´ ìˆœì„œ 1,2,3...']
  icon varchar(255) [null]
  created_at datetime [not null]
}

Table UserBadgeSet {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > User.id]
  user_habit_id bigint [not null, ref: > UserHabit.id]
  badge_set_id bigint [not null, ref: > BadgeSet.id]
  current_badge_id bigint [not null, ref: > Badge.id, note: 'í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ë±ƒì§€']
  current_value int [not null, default: 0]
  created_at datetime [not null]
  updated_at datetime [not null]
}

Table UserBadge {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > User.id]
  badge_id bigint [not null, ref: > Badge.id]
  user_badge_set_id bigint [not null, ref: > UserBadgeSet.id]
  completed_at datetime [not null]
  created_at datetime [not null]
}

Table DailyPage {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > User.id]
  date date [not null]
  content text [not null]
  created_at datetime [not null]
  updated_at datetime [not null]
}

Table AiFeedback {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > User.id]
  date date [not null]
  message text [not null]
  created_at datetime [not null]
}
```

### 5.5 ê´€ê³„ ìš”ì•½

```
User (1) â”€â”€â”€ (N) UserHabit
User (1) â”€â”€â”€ (N) DailyPage
User (1) â”€â”€â”€ (N) AiFeedback
User (1) â”€â”€â”€ (N) UserBadgeSet
User (1) â”€â”€â”€ (N) UserBadge

Habit (1) â”€â”€â”€ (N) UserHabit
Habit (1) â”€â”€â”€ (N) BadgeSet

UserHabit (1) â”€â”€â”€ (N) HabitLog
UserHabit (1) â”€â”€â”€ (N) UserBadgeSet

BadgeSet (1) â”€â”€â”€ (N) Badge
BadgeSet (1) â”€â”€â”€ (N) UserBadgeSet

Badge (1) â”€â”€â”€ (N) UserBadge

UserBadgeSet (1) â”€â”€â”€ (N) UserBadge
UserBadgeSet (N) â”€â”€â”€ (1) Badge [current_badge_id]
```

---

## 6. í–¥í›„ í™•ì¥ ê³ ë ¤ì‚¬í•­

### 6.1 MVP ì´í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì˜í–¥ë°›ëŠ” í…Œì´ë¸” | ë‚œì´ë„ |
|------|----------------|--------|
| ë‹¤ì–‘í•œ ë¸”ëŸ­ íƒ€ì… | PageBlock í…Œì´ë¸” ì¶”ê°€ | ì¤‘ |
| ì±… ë„˜ê¸°ê¸° ë·° | DailyPage ì¡°íšŒ ì¿¼ë¦¬ ë³€ê²½ | ë‚®ìŒ |
| í…œí”Œë¦¿ ê³µìœ  | Template í…Œì´ë¸” ì¶”ê°€ | ì¤‘ |
| ì†Œì…œ/ì±Œë¦°ì§€ | Challenge, ChallengeParticipant ì¶”ê°€ | ë†’ìŒ |
| AI ë±ƒì§€ ìƒì„± | BadgeSet ì»¤ìŠ¤í…€ ìƒì„± ë¡œì§ | ì¤‘ |
| ì´ë©”ì¼ ì¸ì¦ | User.email_verified ì»¬ëŸ¼ + EmailVerification í…Œì´ë¸” | ë‚®ìŒ |
| ì†Œì…œ ë¡œê·¸ì¸ | SocialAccount í…Œì´ë¸” ì¶”ê°€ | ì¤‘ |

### 6.2 DailyPage ë¸”ëŸ­ í™•ì¥ ì‹œ

í˜„ì¬ MVP:
```
DailyPage
- content (í…ìŠ¤íŠ¸ í•˜ë‚˜)
```

í™•ì¥ ì‹œ:
```
DailyPage
- id, user_id, date

PageBlock (ìƒˆë¡œ ì¶”ê°€)
- page_id (FK)
- type ('text' | 'habit' | 'image')
- content
- position (ìˆœì„œ)
```

ê¸°ì¡´ content â†’ PageBlockìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”.

---

## 7. ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

| ì˜ì—­ | ê¸°ìˆ  | ì„ ì • ì´ìœ  |
|------|------|----------|
| Framework | Spring Boot 3.x | ê¸ˆìœµê¶Œ í‘œì¤€ |
| Database | MySQL | ë²”ìš©ì , ë©´ì ‘ ì§ˆë¬¸ ë‹¤ìˆ˜ |
| ORM | Spring Data JPA | N+1 ë“± í•™ìŠµ í¬ì¸íŠ¸ |
| ìºì‹± | Redis | ìŠ¤íŠ¸ë¦­ ìºì‹±, Refresh Token ì €ì¥ |
| ì¸ì¦ | Spring Security + JWT | RTR ë°©ì‹ ì ìš© |
| LLM | OpenAI API | AI í”¼ë“œë°± ìƒì„± |

---

**ë¬¸ì„œ ì‘ì„±ì¼:** 2025ë…„ 1ì›” 25ì¼
**ìµœì¢… ìˆ˜ì •ì¼:** 2025ë…„ 2ì›” 3ì¼
**ì‘ì„±ì:** ì •ìš°ì°¬
